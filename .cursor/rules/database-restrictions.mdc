# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö - –¢–û–õ–¨–ö–û Neon PostgreSQL

> **–ö–†–ò–¢–ò–ß–ù–û**: –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¢–û–õ–¨–ö–û Neon PostgreSQL. –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –°–¢–†–û–ì–û –ó–ê–ü–†–ï–©–ï–ù–´.

## üö´ –ê–ë–°–û–õ–Æ–¢–ù–û –ó–ê–ü–†–ï–©–ï–ù–û

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **SQLite** - –ó–ê–ü–†–ï–©–ï–ù –ø–æ–ª–Ω–æ—Å—Ç—å—é (–≤–∫–ª—é—á–∞—è `sqlite:///`, `aiosqlite`)
- **–õ–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL** - –ó–ê–ü–†–ï–©–ï–ù (`localhost:5432`, `127.0.0.1:5432`)
- **Docker PostgreSQL** - –ó–ê–ü–†–ï–©–ï–ù (–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å postgres –≤ docker-compose)
- **Supabase** - –ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ (–ø—Ä–æ–µ–∫—Ç –º–∏–≥—Ä–∏—Ä–æ–≤–∞–ª –Ω–∞ Neon)
- **Railway PostgreSQL** - –ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨
- **–õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –ë–î** - –ó–ê–ü–†–ï–©–ï–ù–´

### –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –∫–æ–¥–µ
```python
# ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û - SQLite
DATABASE_URL = "sqlite:///./mambax.db"
DATABASE_URL = "sqlite+aiosqlite:///./mambax.db"

# ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û - –õ–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL
DATABASE_URL = "postgresql://user:pass@localhost:5432/db"
DATABASE_URL = "postgresql://user:pass@127.0.0.1:5432/db"

# ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û - Docker PostgreSQL
DATABASE_URL = "postgresql://user:pass@postgres:5432/db"
DOCKER_DATABASE_URL = "..."
```

### –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `*.db` - SQLite —Ñ–∞–π–ª—ã
- `*.sqlite` - SQLite —Ñ–∞–π–ª—ã
- Docker-compose —Å PostgreSQL —Å–µ—Ä–≤–∏—Å–æ–º

## ‚úÖ –ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –†–ê–ó–†–ï–®–ï–ù–ù–ê–Ø –ë–î - Neon PostgreSQL

### Credentials (Production)
```
Host: ep-still-band-agqygsk6-pooler.c-2.eu-central-1.aws.neon.tech
Database: neondb
User: neondb_owner
Project: long-sea-64550481
```

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π DATABASE_URL
```env
# ‚úÖ –¢–û–õ–¨–ö–û –¢–ê–ö
DATABASE_URL=postgresql+asyncpg://neondb_owner:npg_vjOPMFZV5K9n@ep-still-band-agqygsk6-pooler.c-2.eu-central-1.aws.neon.tech/neondb?ssl=require
```

### Neon Dashboard
- URL: https://console.neon.tech
- Project: long-sea-64550481

## üîí –ó–∞—â–∏—Ç–∞ –≤ –∫–æ–¥–µ

### backend/config/settings.py
–°–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–∞—Ç–æ—Ä `validate_database_url()` –∫–æ—Ç–æ—Ä—ã–π:
- –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQLite
- –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å localhost
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –µ—Å–ª–∏ URL –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç "neon.tech"

### backend/db/session.py
–°–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:
- RuntimeError –µ—Å–ª–∏ DATABASE_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- RuntimeError –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω SQLite
- RuntimeError –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω localhost

## üìÅ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### backend/.env
```env
DATABASE_URL=postgresql+asyncpg://neondb_owner:npg_vjOPMFZV5K9n@ep-still-band-agqygsk6-pooler.c-2.eu-central-1.aws.neon.tech/neondb?ssl=require
```

### Vercel Environment Variables
–¢–µ –∂–µ credentials –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤:
- Vercel Dashboard ‚Üí mambax-backend ‚Üí Settings ‚Üí Environment Variables

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

–í Neon —Å–æ–∑–¥–∞–Ω–æ **61 —Ç–∞–±–ª–∏—Ü–∞**:
- Core: users, user_photos, user_interests, swipes, matches, messages, likes, blocks, reports
- Monetization: subscription_plans, user_subscriptions, revenue_transactions, promo_codes...
- Moderation: moderation_logs, banned_users, moderation_queue, appeals...
- Analytics: daily_metrics, retention_cohorts, analytics_events...
- System: audit_logs, feature_flags, security_alerts, backup_status...
- –ò –¥—Ä—É–≥–∏–µ...

## ‚ö†Ô∏è –ü—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏

–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è:
1. –î–æ–±–∞–≤–∏—Ç—å SQLite - **–∫–æ–¥ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è** (RuntimeError)
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å localhost - **–∫–æ–¥ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è** (RuntimeError)
3. –°–æ–∑–¥–∞—Ç—å docker-compose —Å PostgreSQL - **–ù–ï –ú–ï–†–ñ–ò–¢–¨** —Ç–∞–∫–æ–π PR

## üìù –ú–∏–≥—Ä–∞—Ü–∏–∏

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –ë–î:
1. –ò–∑–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤ `backend/models/`
2. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: `alembic revision --autogenerate -m "description"`
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫ Neon: `DATABASE_URL=... alembic upgrade head`

**–ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨** `Base.metadata.create_all()` - —Ç–æ–ª—å–∫–æ Alembic –º–∏–≥—Ä–∞—Ü–∏–∏!
